---
title: "线程模型"
date: 2026-02-28
tags: ["CUDA"]
---

# 线程模型
---

## 定义
**cuda中x和y是笛卡尔坐标系**  
myKernel<<<gridSize, blockSize>>>(...)  
gridSize: [0, int32], [0, uint16], [0, uint16]
基本无限制  
blockSize: [0, 1024], [0, 1204], [0, 64]，
$x \times y \times z$ 的结果不能超过 1024  


## 全局计算
### 一维
$$tid = \text{blockIdx.x} \times \text{blockDim.x} + \text{threadIdx.x}$$
### 二维
$$ix = \text{blockIdx.x} \times \text{blockDim.x} + \text{threadIdx.x}$$
$$iy = \text{blockIdx.y} \times \text{blockDim.y} + \text{threadIdx.y}$$
转换为线性索引
$$id = iy \times Width + ix$$
### 三维
$$ix = \text{blockIdx.x} \times \text{blockDim.x} + \text{threadIdx.x}$$
$$iy = \text{blockIdx.y} \times \text{blockDim.y} + \text{threadIdx.y}$$
$$iz = \text{blockIdx.z} \times \text{blockDim.z} + \text{threadIdx.z}$$
转换为线性索引   
$$(Depth, Height, Width)$$
$$id = iz \times (Height \times Width) + iy \times Width + ix$$

## warp计算
$$lane\_id = tid \ mod \ 32$$
$$lane\_id = tid \ and \ 31$$
$$warp\_id = tid \ / \ 32$$
$$warp\_id = tid \ \gg \ 5$$